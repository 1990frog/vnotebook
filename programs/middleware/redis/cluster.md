[TOC]

# 为什么要集群
1.并发量
2.数据量
3.网络
打个比方：如果一辆马车太重了，一匹马拉不动，那换一只大象来拉，那如果大象也拉不动呢
团队的力量

# 集群：规模化需求
并发量：OPS
数据量：大数据

# 分布式数据库-数据分区
![](_v_images/20200116223414958_150052217.png)

# 顺序分区和哈希分区
![](_v_images/20200116223606765_1808347188.png)

![](_v_images/20200116223623220_737292742.png)

# 哈希分布
+ 节点取余分区
+ 一致性哈希分区
+ 虚拟槽分区

# 节点取余分区
![](_v_images/20200116224045897_1611633980.png)

如果增加了一个节点，会造成数据漂移
![](_v_images/20200116224219351_98350295.png)

![](_v_images/20200116224359471_534280788.png)

# 一致性哈希
![](_v_images/20200116224651085_1354689963.png)

![](_v_images/20200116224857836_1805463799.png)

![](_v_images/20200116224917259_784220741.png)

客户端分片：哈希+顺时针（优化取余）
节点伸缩：只影响临近的节点，但是还是有数据迁移
翻倍伸缩：保证最小迁移数据和负债均衡

# 虚拟槽分区
![](_v_images/20200116230640630_487391151.png)

![](_v_images/20200116230836156_165933686.png)

---

# 基本架构
![](_v_images/20200116231100506_1031913696.png)

![](_v_images/20200116231114843_394156193.png)

![](_v_images/20200116231340759_1111446896.png)

![](_v_images/20200116231438894_2085427869.png)

![](_v_images/20200116231521326_1870262712.png)
![](_v_images/20200116231606734_666556670.png)

![](_v_images/20200116231658725_2039360728.png)

![](_v_images/20200116231742548_77669120.png)
