# RDB
## 优点
+ RDB是一个紧凑压缩的二进制文件，代表Redis在某个时间点上的数据快照。非常适用于备份，全量复制等场景。比如每6个小时执行bgsave备份，并把RDB文件拷贝到远程机器或者文件系统中（如hdfs），用于灾难恢复。（适合大规模的数据恢复）
+ Redis加载RDB恢复数据远远快于AOF的方式。
+ 如果业务对数据完整性和一致性要求不高，RDB是很好的选择。
## 缺点
+ RDB方式数据没办法做到实时持久化/秒级持久化。因为bgsave每次运行都要执行fork操作创建子进程，属于重量级操作，频繁执行成本过高。（耗时、耗性能）
+ RDB文件使用特定二进制格式保存，Redis版本演进过程中有多个格式的RDB版本，存在老版本Redis服务无法兼容新版RDB格式的问题。
+ RDB是保存快照，快照又是基于某一时间点。创建RDB时间点之后的数据可能会丢失。（不可控、丢失数据）
+ 数据的完整性和一致性不高，因为RDB可能在最后一次备份时宕机了。
+  备份时占用内存，因为Redis 在备份时会独立创建一个子进程，将数据写入到一个临时文件（此时内存中的数据是原来的两倍哦），最后再将临时文件替换之前的备份文件。

| 时间戳 |         save          |
| ------ | --------------------- |
| T1     | 执行多个写命令        |
| T2     | 满足RDB自动创建的条件 |
| T3     | 再次执行多个写命令    |
| T4     | 宕机                  |
## 总结
所以Redis 的持久化和数据的恢复要选择在夜深人静的时候执行是比较合理的。