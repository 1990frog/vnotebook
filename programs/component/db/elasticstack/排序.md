
# Function Score Query
可以在查询结束后，对每一个匹配的文档进行一系列的重新算分，根据新生成的分数进行排序

# 提供几种默认的计算分值的函数
+ weight：为每一个文档设置一个简单而不被规范化的权重
+ Field Value Factor：使用该数值来修改_score，例如将“热度”和“点赞数”作为算分的参数（新的算分=老的算分*热点字段数值）
+ Random Score：为每一个用户使用一个不同的，随机算分结果
+ 衰减函数：以某个字段的值为标准，距离某个值越近，得分越高
+ Script Score：自定义脚本完全控制所需逻辑

# Field Value Factor
```json
POST /movie/_search
{
  "query": {
    "function_score": {
      "query": {
        "multi_match": {
          "query": "basketball",
          "fields": ["title","overview"]
        }
      },
      "field_value_factor": {
        "field": "popularity",
        "modifier":""
      },
      "boost_mode":"sum",
      "max_boost":3
    }
  }
}
```
新的分数=老的分数*popularity

modifier
+ none
+ log
+ log1p
+ log2p
+ ln
+ ln1p
+ ln2p
+ square
+ sqrt
+ reciprocal

boost mode
+ multiply：算分与函数值乘积
+ sum：算分与函数的和
+ min/max：算分与函数取最小/最大值
+ replace：使用函数值取代算分

max boost可以将算分控制在一个最大值